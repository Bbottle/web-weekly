{"version":3,"sources":["index.min.js"],"names":["global","doc","document","base","undefined","$","selector","querySelectorAll","key","window","filterName","data","name","filter","date","navigate","hash","match","issue","last","listData","length","rdate","cached","articleEl","innerHTML","htmlEl","classList","remove","LOAD_CLASS","fetch","then","resp","text","html","setTimeout","add","err","console","log","generatearchives","htmls","archivesEl","createElement","className","forEach","d","i","bodyEl","appendChild","hasArchives","onclick","e","target","tagName","toLocaleLowerCase","toggleArchives","location","substring","ARCHIVES","showArchives","isArchivesShown","hideArchives","ARCHIVES_SHOWN","zombieEl","Date","json","onkeyup","keyCode","onhashchange","href","newURL"],"mappings":"AAAA,cAEC,SAAWA,GAGR,GAAIC,GAAMD,EAAOE,SACbC,EAAOC,MAEXD,IACIE,EAAG,SAAWC,GACV,MAAOL,GAAIM,iBAAiBD,IAIpC,KAAK,GAAIE,KAAOL,GACZH,EAAOQ,GAAOL,EAAKK,IAExBC,SAGF,SAAWT,GA2BR,QAASU,GAAWC,EAAMC,GACtB,MAAOD,GAAKE,OAAO,SAAUC,GACzB,MAAOF,IAAQE,IAIvB,QAASC,GAASC,GACd,GAAIC,GAAQb,OACRc,EAAQd,OACRe,EAAOC,EAASA,EAASC,OAAS,EAUtC,QARIJ,EAAQD,EAAKC,MAAMK,KACnBL,EAAQA,EAAM,GACdC,EAAQR,EAAWU,EAAUH,GAC7BC,EAAQA,EAAMG,OAASH,EAAM,GAAKC,GAElCD,EAAQC,EAGRI,EAAOL,GACAM,EAAUC,UAAYF,EAAOL,IAGxCQ,EAAOC,UAAUC,OAAOC,OACxBC,GAAM,0BAA4BZ,EAAQ,SAASa,KAAK,SAAUC,GAC9D,MAAOA,GAAKC,SACbF,KAAK,SAAUG,GACdX,EAAOL,GAASgB,EAChBV,EAAUC,UAAYS,EACtBC,WAAW,WACPT,EAAOC,UAAUS,IAAIP,IACtB,OACJ,SAAS,SAAUQ,GAClB,MAAOC,SAAQC,IAAIF,MAI3B,QAASG,KACL,GAAIC,GAAQ,EACZC,GAAaxC,SAASyC,cAAc,MAEpCD,EAAWE,UAAY,WACvBF,EAAWjB,UAAY,WAInB,MAHAL,GAASyB,QAAQ,SAAUC,EAAGC,GAC1BN,GAAS,iBAAoBK,EAAI,OAAUC,EAAI,GAAK,cAEjDN,KAGXO,EAAOC,YAAYP,GAEnBQ,GAAc,EACdR,EAAWS,QAAU,SAAUC,GACiB,KAAxCA,EAAEC,OAAOC,QAAQC,qBACjBC,KAIJC,SAASzC,KAAK0C,UAAU,IAAMC,GAC9BC,IAIR,QAASJ,KACDN,IACAW,EAAkBC,IAAiBF,KAI3C,QAASE,KACLpC,EAAOC,UAAUC,OAAOmC,GACxBF,GAAkB,EAGtB,QAASD,KACLlC,EAAOC,UAAUS,IAAI2B,GACrBF,GAAkB,EApGtB,GAAIxD,GAAIL,EAAOK,EACXyB,EAAQ9B,EAAO8B,MACfJ,EAASrB,EAAE,QAAQ,GACnB2C,EAAS3C,EAAE,QAAQ,GACnBmB,EAAYnB,EAAE,YAAY,GAC1B2D,EAAW3D,EAAE,WAAW,GACxBkB,KACAD,EAAQ,wBACRuC,GAAkB,EAClBX,GAAc,EACdS,EAAW,WACXI,EAAiB,iBACjBlC,EAAa,SACbT,EAAWhB,OACXsC,EAAatC,MAEjB0B,GAAM,kBAAmB,GAAImC,OAAQlC,KAAK,SAAUC,GAChD,MAAOA,GAAKkC,SACbnC,KAAK,SAAUpB,GACdS,EAAWT,EACXI,EAAS0C,SAASzC,KAAK0C,UAAU,IACjClB,MAkFJnC,EAAE,aAAa,GAAG8C,QAAUK,EAE5BxD,EAAOmE,QAAU,SAAUf,GACV,IAAbA,EAAEgB,SAAiBN,KAGvB9D,EAAOqE,aAAe,SAAUjB,GAC5B,GAAIpC,GAAOZ,MACX4D,GAASM,KAAOlB,EAAEmB,OAClBvD,EAAOgD,EAAShD,KAAK0C,UAAU,GAC3B1C,GAAQ2C,EACRC,KAEAE,IACA/C,EAASC,MAGlBP","file":"index.min.js","sourcesContent":["\"use strict\";\n\n~(function (global) {\n    \"use strict\";\n\n    var doc = global.document,\n        base = undefined;\n\n    base = {\n        $: function $(selector) {\n            return doc.querySelectorAll(selector);\n        }\n    };\n\n    for (var key in base) {\n        global[key] = base[key];\n    }\n})(window);\n\"use strict\";\n\n~(function (global) {\n    \"use strict\";\n\n    var $ = global.$,\n        fetch = global.fetch,\n        htmlEl = $(\"html\")[0],\n        bodyEl = $(\"body\")[0],\n        articleEl = $(\"#article\")[0],\n        zombieEl = $(\"#zombie\")[0],\n        cached = {},\n        rdate = /(\\d{4}\\-\\d{2}\\-\\d{2})/,\n        isArchivesShown = false,\n        hasArchives = false,\n        ARCHIVES = \"archives\",\n        ARCHIVES_SHOWN = \"archives-shown\",\n        LOAD_CLASS = \"loaded\",\n        listData = undefined,\n        archivesEl = undefined;\n\n    fetch(\"datas.json?t=\" + +new Date()).then(function (resp) {\n        return resp.json();\n    }).then(function (data) {\n        listData = data;\n        navigate(location.hash.substring(1));\n        generatearchives();\n    });\n\n    function filterName(data, name) {\n        return data.filter(function (date) {\n            return name == date;\n        });\n    }\n\n    function navigate(hash) {\n        var match = undefined,\n            issue = undefined,\n            last = listData[listData.length - 1];\n\n        if (match = hash.match(rdate)) {\n            match = match[1];\n            issue = filterName(listData, match);\n            issue = issue.length ? issue[0] : last;\n        } else {\n            issue = last;\n        }\n\n        if (cached[issue]) {\n            return articleEl.innerHTML = cached[issue];\n        }\n\n        htmlEl.classList.remove(LOAD_CLASS);\n        fetch(\"contents/indeterminate/\" + issue + \".html\").then(function (resp) {\n            return resp.text();\n        }).then(function (html) {\n            cached[issue] = html;\n            articleEl.innerHTML = html;\n            setTimeout(function () {\n                htmlEl.classList.add(LOAD_CLASS);\n            }, 1000);\n        })[\"catch\"](function (err) {\n            return console.log(err);\n        });\n    }\n\n    function generatearchives() {\n        var htmls = \"\";\n        archivesEl = document.createElement(\"ul\");\n\n        archivesEl.className = \"archives\";\n        archivesEl.innerHTML = (function () {\n            listData.forEach(function (d, i) {\n                htmls += \"<li><a href=\\\"#\" + d + \"\\\">#\" + (i + 1) + \"</a></li>\";\n            });\n            return htmls;\n        })();\n\n        bodyEl.appendChild(archivesEl);\n\n        hasArchives = true;\n        archivesEl.onclick = function (e) {\n            if (e.target.tagName.toLocaleLowerCase() == \"a\") {\n                toggleArchives();\n            }\n        };\n\n        if (location.hash.substring(1) == ARCHIVES) {\n            showArchives();\n        }\n    }\n\n    function toggleArchives() {\n        if (hasArchives) {\n            isArchivesShown ? hideArchives() : showArchives();\n        }\n    }\n\n    function hideArchives() {\n        htmlEl.classList.remove(ARCHIVES_SHOWN);\n        isArchivesShown = false;\n    }\n\n    function showArchives() {\n        htmlEl.classList.add(ARCHIVES_SHOWN);\n        isArchivesShown = true;\n    }\n\n    $(\"#archives\")[0].onclick = toggleArchives;\n\n    global.onkeyup = function (e) {\n        e.keyCode == 27 && hideArchives();\n    };\n\n    global.onhashchange = function (e) {\n        var hash = undefined;\n        zombieEl.href = e.newURL;\n        hash = zombieEl.hash.substring(1);\n        if (hash == ARCHIVES) {\n            showArchives();\n        } else {\n            hideArchives();\n            navigate(hash);\n        }\n    };\n})(window);"],"sourceRoot":"/source/"}